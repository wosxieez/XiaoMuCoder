package com.xiaomu.view.stageview
{
	import com.xiaomu.event.RoleEvent;
	import com.xiaomu.manager.RoleManager;
	
	import flash.events.MouseEvent;
	
	import coco.component.SkinComponent;
	import coco.event.UIEvent;
	
	public class StageView extends SkinComponent
	{
		public function StageView()
		{
			super();
			
			borderAlpha = backgroundAlpha = 1;
			borderColor = 0xF0E7CC;
			backgroundColor = 0xFEFBF0;
			RoleManager.getInstance().addEventListener(RoleEvent.ADD_ROLE,addRoleHandler);
			RoleManager.getInstance().addEventListener(RoleEvent.SELECTED_ROLE,selectedRoleHandler);
		}
		
		private var transformer:Transformer;
		
		override protected function createChildren():void
		{
			super.createChildren();
			
			transformer = new Transformer();
			transformer.x = transformer.y = 100;
			transformer.addEventListener(MouseEvent.CLICK, transformer_clickHandler);
			addChild(transformer);
		}
		
		protected function transformer_clickHandler(event:MouseEvent):void
		{
			trace("i am click");
		}
		
		override protected function drawSkin():void
		{
			super.drawSkin();
			
			graphics.beginFill(0xF9F4E6);
			graphics.drawRect(0, height - 30, width, 30);
			graphics.endFill();
		}
		
		protected function selectedRoleHandler(event:RoleEvent):void
		{
			trace("stageView区获取到你在RoleView区选择的角色图片的源是");
		}
		private var img:RoleComponent;
		protected function addRoleHandler(event:RoleEvent):void
		{
			img = new RoleComponent();
			img.x = (width- img.width)/2;
			img.y = (height - img.height)/2;
			img.addEventListener(MouseEvent.MOUSE_DOWN , onDownHandler);
			img.addEventListener(MouseEvent.MOUSE_UP,onUpHandler);
			addChild(img);
		}		
		
		protected function onUpHandler(event:MouseEvent):void
		{
			event.currentTarget.stopDrag();
		}
		
		protected function onDownHandler(event:MouseEvent):void
		{
			event.currentTarget.startDrag(false);
		}
		
		protected function onMouseUpHandler(event:MouseEvent):void
		{
			event.currentTarget.stopDrag();
		}
		
		protected function onMouseDownHandler(event:MouseEvent):void
		{
			event.currentTarget.startDrag(false);
		}
		
		private var rc:RoleComponent;
		protected function dropHandler(event:UIEvent):void
		{
		}
		
	}
}